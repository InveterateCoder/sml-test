{"version":3,"file":"server.js","sources":["webpack://sml-test/server.js"],"sourcesContent":["(()=>{\"use strict\";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=require(\"path\");var n=e.n(t);const r=require(\"dotenv\");var s=e.n(r);const i=require(\"dotenv-expand\");var a=e.n(i);const o=require(\"express\");var d=e.n(o);const u=require(\"mongoose\"),m=require(\"swagger-ui-express\");var c=e.n(m);const p=JSON.parse('{\"openapi\":\"3.0.0\",\"info\":{\"title\":\"Test App\",\"description\":\"Test app for Soft Media Lab.\",\"version\":\"1.0.0\",\"contact\":{\"name\":\"Arthur Grigoryan\",\"url\":\"https://inveteratecoder.github.io/\",\"email\":\"inveterate.coder@gmail.com\"}},\"servers\":[{\"url\":\"/api\",\"description\":\"api gateway\"}],\"paths\":{\"/students\":{\"get\":{\"summary\":\"Returns students.\",\"description\":\"Returns a list of all students in the db.\",\"responses\":{\"200\":{\"description\":\"A JSON array of student objects\",\"content\":{\"application/json\":{\"schema\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"id\":{\"type\":\"string\"},\"firstName\":{\"type\":\"string\"},\"lastName\":{\"type\":\"string\"},\"middleName\":{\"type\":\"string\"},\"avatar\":{\"type\":\"string\"},\"dob\":{\"type\":\"string\"},\"grade\":{\"type\":\"integer\"},\"performance\":{\"type\":\"integer\"}}}}}}}}}}}}'),l=new u.Schema({avatar:String,firstName:{type:String,minlength:[2,\"Minimum first name's length is 2\"],maxlength:[26,\"Maximum first name's length is 26\"],required:[!0,\"Must provide the student's first name\"],index:!0},lastName:{type:String,minlength:[2,\"Minimum last name's length is 2\"],maxlength:[26,\"Maximum last name's length is 26\"],required:[!0,\"Must provide the student's last name\"],index:!0},middleName:{type:String,minlength:[2,\"Minimum middle name's length is 2\"],maxlength:[26,\"Maximum middle name's length is 26\"],required:[!0,\"Must provide the student's middle name\"],index:!0},dob:{type:Date,required:[!0,\"Must provide the student's date of birth\"]},grade:{type:Number,min:[1,\"Wrong grade number\"],max:[5,\"Wrong grade number\"],required:[!0,\"Must provide the student's class\"]},performance:{type:Number,min:[2,\"Wrong performance mark\"],max:[5,\"Wrong performance mark\"],required:[!0,\"Must provide the student's performance\"]}}),g=(0,u.model)(\"Student\",l),h=(0,o.Router)();h.get(\"/students\",(async function(e,t){try{const e=(await g.find({}).exec()).map((e=>{const t=e.toObject();return{id:t._id,...t,_id:void 0,__v:void 0}}));t.json(e)}catch(e){t.status(500).send(e.message)}}));const v=h,y=async function(e,t){try{t.render(\"index\")}catch(e){t.status(500).send(e.message)}};a()(s().config());const f=process.env.DB_URL||\"mongodb://localhost:27017/fake_school\",b=process.env.PORT||8e3;!async function(){const e=d()();e.set(\"view engine\",\"ejs\");let t=null;try{e.use(d().static(n().resolve(__dirname,\"public\"))).use(d().json()).use(d().urlencoded({extended:!0})).use(\"/api-docs\",c().serve,c().setup(p)).use(\"/api\",v),e.get(\"*\",y),await(0,u.connect)(f,{useNewUrlParser:!0,useUnifiedTopology:!0,useCreateIndex:!0}),t=e.listen(b,(()=>console.log(\"server started on port \"+b)))}catch(e){var r;null===(r=t)||void 0===r||r.close(),console.error(e)}}()})();"],"mappings":"AAAA","sourceRoot":""}